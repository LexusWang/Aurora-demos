In the **SolarWinds Compromise**, APT29 executed a highly sophisticated, multi-stage attack beginning with **supply chain infiltration** by embedding the **SUNBURST** malware into trojanized SolarWinds Orion updates. Upon deployment, the malware leveraged **PowerShell** and **cmd.exe** to execute commands, discover domain accounts (via `Get-ADUser`, `Get-ADGroupMember`), and enumerate permissions (`Get-ManagementRoleAssignment`). To establish persistence, APT29 manipulated **scheduled tasks**, **WMI event subscriptions**, and **registry keys**, while abusing compromised **domain administrator** and **O365 cloud accounts** to escalate privileges and forge **SAML tokens** for bypassing MFA.
The group conducted extensive **credential theft**, stealing Chrome passwords, Kerberos tickets (via **Kerberoasting**), and private keys from Active Directory Federation Services (AD FS). Lateral movement was achieved through **RDP**, **SMB/Admin Shares**, and **WinRM**, while **Cobalt Strike** and **TEARDROP** malware facilitated remote control. Data collection targeted **emails** (via `New-MailboxExportRequest`), **source code repositories**, and **internal wikis**, with stolen data compressed into **password-protected 7-Zip archives** and staged on OWA servers for exfiltration over HTTPS.
APT29 employed advanced **defense evasion** tactics: disabling security tools (`AUDITPOL`, `netsh`), **timestomping** files to mimic legitimate timestamps, masquerading tasks/services (e.g., `SoftwareProtectionPlatform`), and signing malware with stolen SolarWinds certificates. Infrastructure was obscured using **dynamic DNS** for C2, **IP geolocation spoofing**, and **internal proxy** techniques (SSH port forwarding). Finally, the actors **deleted tools** and cleared forensic traces (`Remove-MailboxExportRequest`), ensuring stealth throughout the operation. This campaign underscores APT29â€™s mastery of **blending legitimate tools**, **cloud abuse**, and **identity-centric attacks** to achieve prolonged, undetected access.
