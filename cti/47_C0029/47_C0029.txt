During the Cutting Edge campaign, threat actors initiated reconnaissance by scanning for Ivanti Connect Secure VPNs vulnerable to CVE-2024-21893 using the Interactsh tool. They then exploited a chain of vulnerabilities (CVE-2023-46805, CVE-2024-21887, and CVE-2024-21893) to bypass authentication and execute command injection on targeted VPN appliances. To establish persistence, they trojanized legitimate Ivanti binaries, deployed multiple web shells (e.g., WIREFIRE, GLASSTOKEN), and injected malicious code via SparkGateway plugins to load backdoors into memory.
For defense evasion, attackers systematically disabled logging, modified the Integrity Checker exclusion list to hide artifacts, and employed timestomping to alter file metadata. They further obscured activities by deleting temporary files (e.g., /tmp/test1.txt) containing stolen VPN configurations and cache data, while using Base64-encoded Python scripts to patch system binaries like dsls. Credential harvesting was achieved through web portal keylogging via modified JavaScript on VPN login pages and LSASS/NTDS dumping from compromised Windows devices.
Lateral movement leveraged compromised domain accounts across protocols including RDP, SMB, and SSH. Command and control relied on layered techniques: DNS tunneling via Iodine, Unix sockets, reverse TCP shells, and the PySoxy SOCKS5 proxy. Data exfiltration involved archiving stolen information into tar files and using tools like Kubo Injector to manipulate memory. Infrastructure-wise, attackers repurposed out-of-support Cyberoam VPNs for C2 while employing utilities such as BusyBox and ENUM4LINUX for post-exploitation reconnaissance.
The operation culminated in advanced persistence mechanisms like the PITSOCK backdoor, activated via a magic 48-byte sequence over custom sockets, demonstrating a blend of vulnerability chaining, living-off-the-land binaries, and multi-protocol C2 to maintain stealth.
