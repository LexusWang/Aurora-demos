<!-- [![Release](https://img.shields.io/badge/dynamic/json?color=blue&label=Release&query=tag_name&url=https%5B%5D)](https:%5B%5D) -->
![License](https://img.shields.io/github/license/LexusWang/Aurora-demos)

# Aurora-demos: Automated Cyberattack Emulation

üö® **Test your defense systems with live, high-fidelity cyberattacks ‚Äî or build real-world datasets about attack traces!** üö®

Welcome to a repository of emulated cyberattacks generated by Aurora ‚Äî an automated cyberattack emulation system powered by symbolic planning and large language models (LLMs).
Perfect for stress-testing defenses or collecting detailed system traces during simulated intrusions.

## Updates and News
- [Updated on 01/06/2025] We added emulated attacks customized based on 250 different CTI reports.

## üéâ Introduction

Aurora is a framework that can automatically construct cyberattacks for emulation.
Using LLM capabilities, it leverages external attack tools and threat intelligence reports.
This repository stores the **outputs** of Aurora.
For more designing details about of Aurora, please refer to [this page](docs/aurora_introduction.md).

‚è∞ We are preparing publishing the source code of Aurora.

If you use the cyberattacks in this repo, please cite our paper. Thanks! ‚ò∫Ô∏è
```
@article{wang2024sands,
  title={From Sands to Mansions: Towards Automated Cyberattack Emulation with Classical Planning and Large Language Models},
  author={Wang, Lingzhi and Li, Zhenyuan and Jiang, Yi and Wang, Zhengkai and Guo, Zonghan and Wang, Jiahui and Wei, Yangyang and Shen, Xiangmin and Ruan, Wei and Chen, Yan},
  journal={arXiv preprint arXiv:2407.16928},
  year={2024},
  archivePrefix={arXiv},
  url={https://arxiv.org/abs/2407.16928}
}
```

## Attack Emulation Plans

The `attacks/` folder stores the emulated cyberattacks.
Each folder in `attacks/` contains an attach chain, which includes:
- `readme.md`: The human-readable documentation of the emulated attack;
- `attack_chain.yml`: The raw data of the emulated attack;
- `attack_chain.py`: The Python script to execute the emulated attack.

For more details, please refer to the [introduction to attack chains](https://github.com/LexusWang/Aurora-demos/blob/main/docs/attack_chain_introduction.md).

## Execute Attacks
We show how to reproduce (execute) the generated attacks in this section.
Please clone this repo first:
```bash
git clone https://github.com/LexusWang/Aurora-demos.git && cd Aurora-demos
```

### 0. Dependencies
Viewing the attacks in this repo does not require any dependencies.
To reproduce the attacks, however, you will need to install [VirtualBox](https://www.virtualbox.org/wiki/Downloads) for deploying and managing virtual machines (we use VirtualBox as the default virtualization software; VMware users can manually download and deploy the virtual machines).

Specifically, You need to know the path of the command-line interface (CLI) tool for VirtualBox (e.g. `C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe` or `/usr/bin/VBoxManage`).

### 1. Deploy the attack emulation environments:
To execute an emulated attack, you first need to deploy the attack environment, including both the attacker and victim machines.

Each attack plan defines its required environment in the `attack_chain.yml` file. You can easily deploy it by running a Python script. For example:

```bash
python pull.py --attack_plan attacks/1_AA23-341A/attack_chain.yml
```

If you want to build the emulation environments by yourself, please refer to this [page](docs/environment_introduction.md).

We provide an example of the deployed attack emulation environments including two attacker machines and three victim machines [here](https://github.com/LexusWang/Aurora-demos/blob/main/docs/Emulation_Infrastructure_info.md).

<!-- ### 2. Generate attack scripts:
‚è© (For now users can skip this step since we have already generated the attack execution script for each attack chain.)

Aurora provides a semi-automatic execution script in Python for each attack chain (`attack_chain.yml`).
This design simplifies user configuration and minimizes manual intervention.
The Python scripts are generated by calling `generateExecution.py`.

```bash
python aurora/executor/generateExecution.py --input #YAMLFilePath --output #OutputPath
```

- `#YAMLFilePath` : Input source (directory containing `attack_chain.yml` files or specific YAML configuration)
- `#OutputPath` : Target directory for generated executable attack scripts

```bash
# Processes all attack plans in the publish-2.0 directory and outputs generated scripts to results/scripts
python generateExecution.py --input publish-2.0 --output results/scripts
# Generates execution scripts only for the attack plan in the subdirectory
python generateExecution.py --input publish-2.0/active_desktop_info_known-1 --output results/scripts
# Directly processes the single attack_chain.yml file under the subdirectory
python generateExecution.py --input publish-2.0/active_desktop_info_known-1/attack_chain.yml --output results/scripts
```

<p align="center">

<img src="images/generateExecution.gif" alt="editor" align="center"/>

</p> -->

### 2. Execute attack scripts:
Once the emulation environment is deployed, follow the steps below to execute the attacks:

1. Move `attack_chain.py` to the attacker machine;
2. Open the terminal, run `attack_chain.py` on the attacker machine;
3. Follow the guidance and instructions from the terminal, set the parameters (e.g. IP addresses of the related VMs);
4. Some steps may need human intervention, please follow the guidance and instructions from the terminal.

Click the following headings to watch some demos:
<details>
<summary>EXAMPLE-1_execution_keyboard_input_simulated-3</summary>

This attack plan uses `Metasploit` and `Sliver` tools to compromise Windows systems. First, a listener is established to capture incoming connections. A malicious `Sliver` payload is then created and delivered by tricking the victim into downloading/running it, granting remote access. Finally, this access is leveraged to deploy a stealthy `Meterpreter` payload via `Sliver` for data exfiltration (`keyboard input simulation`)


![progress](images/example1.gif)

</details>

<details>
<summary>EXAMPLE-2_execution_file_info_known-1</summary>

This attack simulation targets Windows systems using `Sliver` and `Metasploit`. It starts by creating a `Sliver` implant (malicious.exe) and tricking the victim into downloading/running it as Administrator. This grants attackers an elevated `Sliver` C2 session. Next, a `Metasploit` listener is set up to catch a reverse HTTPS payload ("meterpreter_reverse_http") deployed through `Sliver`, enabling a stealthy `Meterpreter` session. Finally, attackers use `Meterpreter` to search for sensitive files (like *.txt) on compromised machines.


![progress](images/example2.gif)
</details>

<details>
<summary>EXAMPLE-3_execution_active_desktop_info_known-1</summary>

This attack simulation targets Windows systems using `Sliver` and `Metasploit`. It starts by creating a `Sliver` implant (malicious.exe) and tricking the victim into downloading/running it as Administrator. This grants attackers an elevated `Sliver` C2 session. Next, a `Metasploit` listener is set up to catch a reverse HTTPS payload ("meterpreter_reverse_http") deployed through `Sliver`, enabling a stealthy `Meterpreter` session. Finally, attackers use `Meterpreter` to display the current active desktop session information on compromised machines.


![progress](images/active_desktop_info_known-1.gif)
</details>

</details>

<details>
<summary>EXAMPLE-4_execution_arp_info_known-1</summary>

This attack simulation targets Windows systems using `Sliver` and `Metasploit`. It starts by creating a `Sliver` implant (malicious.exe) and tricking the victim into downloading/running it as Administrator. This grants attackers an elevated `Sliver` C2 session. Next, a `Metasploit` listener is set up to catch a reverse HTTPS payload ("meterpreter_reverse_http") deployed through `Sliver`, enabling a stealthy `Meterpreter` session. Finally, attackers use `Meterpreter` to displays the target's ARP cache.


![progress](images/arp_info_known-1.gif)
</details>

<details>
<summary>EXAMPLE-5_bind_named_pipe_listener-1</summary>

This attack simulation targets Linux systems using `Metasploit`. It exploits the `CVE-2020-25213` vulnerability of the target. Use the exploit module: `multi/http/wp_file_manager_rce` and the payload: `php/bind_php`. Finally, a shell session is established.


![progress](images/bind_named_pipe_listener-1.gif)
</details>

## Mimicking CTI Reports
As demonstrated in the paper, Aurora can tailor generated attacks based on CTI reports to mimic specific real-world APT groups.
While ensuring the correctness and causality of the attacks, Aurora selects TTPs that closely match those described in the reports.
Here are the CTI reports covered by in this repo.

| Index | CTI Report |
| --- | --- |
| 1 | [AA23-341A](attacks/1_AA23-341A/readme.md) |
| 2 | [AA24-046A](attacks/2_AA24-046A/readme.md) |
| 3 | [ALPHVBlackcat](attacks/3_ALPHVBlackcat/readme.md) |
| 4 | [PhobosRansomware](attacks/4_PhobosRansomware/readme.md) |
| 5 | [PlayRansomware](attacks/5_PlayRansomware/readme.md) |
| 6 | [RhysidaRansomware](attacks/6_RhysidaRansomware/readme.md) |
| 7 | [ScatteredSpider](attacks/7_ScatteredSpider/readme.md) |
| 8 | [SnatchRansomware](attacks/8_SnatchRansomware/readme.md) |
| 9 | [BlackBasta](attacks/9_BlackBasta/readme.md) |
| 10 | [RoyalRansomware](attacks/10_RoyalRansomware/readme.md) |
| 11 | [DeputydogCampaign](attacks/11_DeputydogCampaign/readme.md) |
| 12 | [DustySkyCampaign](attacks/12_DustySkyCampaign/readme.md) |
| 13 | [TrickLoadSpywareCampaign](attacks/13_TrickLoadSpywareCampaign/readme.md) |
| 14 | [HawkEyeCampaign](attacks/14_HawkEyeCampaign/readme.md) |
| 15 | [EmotetCampaign](attacks/15_EmotetCampaign/readme.md) |
| 16 | [UroburosCampaign](attacks/16_UroburosCampaign/readme.md) |
| 17 | [APT41Campaign](attacks/17_APT41Campaign/readme.md) |
| 18 | [EspionageCampaign](attacks/18_EspionageCampaign/readme.md) |
| 19 | [SSHBinFmt-Elevate](attacks/19_SSHBinFmt-Elevate/readme.md) |
| 20 | [Crambus](attacks/20_Crambus/readme.md) |
| 21 | [IcedID](attacks/21_IcedID/readme.md) |
| 22 | [Clasiopa](attacks/22_Clasiopa/readme.md) |
| 23 | [C0001](attacks/23_C0001/readme.md) |
| 24 | [C0002](attacks/24_C0002/readme.md) |
| 25 | [C0004](attacks/25_C0004/readme.md) |
| 26 | [C0005](attacks/26_C0005/readme.md) |
| 27 | [C0006](attacks/27_C0006/readme.md) |
| 28 | [C0007](attacks/28_C0007/readme.md) |
| 29 | [C0010](attacks/29_C0010/readme.md) |
| 30 | [C0011](attacks/30_C0011/readme.md) |
| 31 | [C0012](attacks/31_C0012/readme.md) |
| 32 | [C0013](attacks/32_C0013/readme.md) |
| 33 | [C0014](attacks/33_C0014/readme.md) |
| 34 | [C0015](attacks/34_C0015/readme.md) |
| 35 | [C0016](attacks/35_C0016/readme.md) |
| 36 | [C0017](attacks/36_C0017/readme.md) |
| 37 | [C0018](attacks/37_C0018/readme.md) |
| 38 | [C00020](attacks/38_C00020/readme.md) |
| 39 | [C0021](attacks/39_C0021/readme.md) |
| 40 | [C0022](attacks/40_C0022/readme.md) |
| 41 | [C0023](attacks/41_C0023/readme.md) |
| 42 | [C0024](attacks/42_C0024/readme.md) |
| 43 | [C0025](attacks/43_C0025/readme.md) |
| 44 | [C0026](attacks/44_C0026/readme.md) |
| 45 | [C0027](attacks/45_C0027/readme.md) |
| 46 | [C0028](attacks/46_C0028/readme.md) |
| 47 | [C0029](attacks/47_C0029/readme.md) |
| 48 | [C0030](attacks/48_C0030/readme.md) |
| 49 | [C0031](attacks/49_C0031/readme.md) |
| 50 | [C0032](attacks/50_C0032/readme.md) |
| 51 | [C0033](attacks/51_C0033/readme.md) |
| 52 | [C0034](attacks/52_C0034/readme.md) |
| 53 | [C0035](attacks/53_C0035/readme.md) |
| 54 | [C0036](attacks/54_C0036/readme.md) |
| 55 | [C0037](attacks/55_C0037/readme.md) |
| 56 | [C0038](attacks/56_C0038/readme.md) |
| 57 | [C0039](attacks/57_C0039/readme.md) |
| 58 | [C0040](attacks/58_C0040/readme.md) |

## Licensing
Distributed under the Apache License 2.0 License.
See `LICENSE` for more information.
The attack chains are for education, research, and testing purpose.
The author does not condone any illegal use.
Use as your own risk.

## Contact the Contributors!
- Lingzhi Wang - [lingzhiwang2025@u.northwestern.edu](lingzhiwang2025@u.northwestern.edu)
- Yi Jiang - [jiangyi99@zju.edu.cn](jiangyi99@zju.edu.cn)
- Zhengkai Wang - [wangzhengkai@zju.edu.cn](wangzhengkai@zju.edu.cn)
