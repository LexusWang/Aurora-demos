[![Release](https://img.shields.io/badge/dynamic/json?color=blue&label=Release&query=tag_name&url=https%5B%5D)](https:%5B%5D)

# Aurora-demos

This project contains the attack chains generated by Aurora, a cyberattack emulation system leveraging classical planning (PDDL) and Large Language Models (LLMs).

Aurora is a framework that can automatically construct multi-step cyberattacks (attack chains), set up emulation environments, and semi-automatically execute the generated attack chains. With the help of LLM, it makes use of external attack tools and threat intelligence reports.

We are preparing publishing the source code of Aurora.

## üéâ Introduction

<p><a href="https://arxiv.org/pdf/2407.16928"><img src="images/First_page.png" alt="Paper thumbnail" align="right" width="160"/></a></p>

-   Introduces AURORA, an cyberattack emulation system leveraging classical planning (PDDL) and Large Language Models (LLMs).
-   Automates construction of a 5,000+ action attack space with over 1,000 chains.
-   AURORA generates higher quality attack plans with broader TTP coverage.

Our paper: [From Sands to Mansions: Towards Automated Cyberattack Emulation with Classical Planning and Large Language Models](https://arxiv.org/pdf/2407.16928)

## Resources & Socials

-   üìú [Documentation, training, and use-cases]()(Coming Soon)
-   ‚úçÔ∏è [aurora's blog]()(Coming Soon)
-   üåê [Homepage](https://auroraattack.github.io/)

## System Overview

<p align="center">

<img src="images/framework.png" alt="cli output" width="1000"/>

</p>


Aurora‚Äôs architecture comprises five components:

- `Attack Tool Analysis`: Converts third-party tool documentation into structured attack actions using rule-based and LLM-assisted predicate extraction.

- `Attack Report Analysis`: Extracts Tactics, Techniques, and Procedures (TTPs) from CTI reports via LLMs to guide attack planning.

- `Attack Planning`: Uses PDDL and reward functions (aligned with CTI-derived TTPs) to generate attack chains.

- `Attack Environment Builder`: Deploys pre-configured virtual machines to replicate vulnerable environments.

- `Attack Execution`: Semi-automatically runs attack scripts and collects traces for dataset construction.

## Attack Chains

This repo stores attack chains generated by Aurora, which can be found in the `attack_chains/` folder.
Each folder in `attack_chains/` contains an attach chain, which includes the details of the attack chain and an attack execution script (in Python).

For more details, please refer to the [introduction to attack chains](https://github.com/LexusWang/Aurora-demos/blob/main/docs/attack_chain_introduction.md).

## Execute Attack Chains
We show how to reproduce (execute) the generated attacks in this section.
Please clone this repo first:
```
git clone https://github.com/LexusWang/Aurora-demos.git && cd Aurora-demos
```

### 0. Dependencies
Before beginning, you need to set up an attack machine equipped with the necessary attack tools.
Specifically, we use [Attack Executor](https://github.com/LexusWang/attack_executor) to execute the attack actions provided by different attack tools.

Detailed configuration steps are documented in [Guide](./docs/attacker_environment_setup_guide.md).
Follow this guide to configure the attack machine for attack execution.

We‚Äôve also prepared pre-configured attack machine for you! You can download and deploy it directly from [here](https://drive.google.com/file/d/1FCBZtsHM363eWor1xep4CzfNtMSio-RS/view?usp=drive_link) or using this command:
```
python pull.py -p attacker -d download -vm C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe --url_table docs\url_table.csv -nr
```

### 1. Pull and deploy the attack emulation environments:
After deploying the attack machine in Step 0, we need to set up the attack emulation environments (the victim machines).

Running `pull.py` on the attack chain YML file automatically downloads and deploys the corresponding victim virtual machines. (we use VirtualBox as the default virtualization software; VMware users can manually download and deploy the virtual machines).

``` bash
## Prohibit repeated VM downloading
python pull.py -p #yml_file_path -d #storage_path -vm #VBoxManage.exe_path --url_table #url_table_path -nr -firewall #yes/no
```
- `-p #yml_file_path`ÔºöThe path of the attack chain `.yml` file;  
- `-d #storage_path`ÔºöThe storage path of the downloaded VM file;  
- `-vm #VBoxManage.exe_path`ÔºöThe path of installed VirtualBox executable file (`VBoxManage.exe`);  
- `--url_table #url_table_path`ÔºöThe path of the Download Link mapping table (url_table.csv);
- `-nr`ÔºöProhibiting duplicate deployment;
- `-r`ÔºöAllowing duplicate downloads;
- `-firewall #yes/no`ÔºöUse pfSense firewall to isolate the attack host and the target host.  

Notes:
- Two download modes are supported:
  - No duplication (`-nr`): If the VM image file already exists, it will skip the downloading and directly proceed with deployment.
  - Allow duplications (`-r`): VM image files will be automatically redownloaded and renamed to avoid conflicts.

- During initial deployment, the VM will not start automatically, allowing users to modify configurations.

- By default, two network adapters will be configured: one in NAT mode and the other in Host-only mode. Make sure the required network is configured in VirtualBox; otherwise, the VM may fail to start.


<!-- Example:If you don't want to allow repeated downloads of the attack chain "examples\access_encrypted_edge_credentials\attack_plan.yml" corresponding to the range. You can use  -->
Example: Deploy the emulation environments of the attack chain "examples\access_encrypted_edge_credentials\attack_plan.yml":
``` bash
python pull.py -p examples\access_encrypted_edge_credentials\attack_plan.yml -d download -vm C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe --url_table docs\url_table.csv -nr -firewall no
```
If the VM image file has been downloaded before, it will display:
<p align="center">

<img src="images/No_repeat.png" alt="request" width="1200"/>

</p>
Entering "yes" will directly start the corresponding virtual machine.
On the contrary, if duplication is allowed, the VM image file will be redownloaded and renamed to avoid conflicts.


<!-- ``` bash
python pull.py -p examples\access_encrypted_edge_credentials\attack_plan.yml -d download -vm C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe --url_table docs\url_table.csv -nr -firewall yes
``` -->
If you want to use firewall for isolation. Just set `-firewall` as `yes`. 
<!-- If it was not downloaded originally, firewall.ova will be automatically downloaded. If there is already a download, it will skip and ask if you want to start it. -->

When using pfsense, the configuration interface is as follows:
<p align="center">

<img src="images/pfsense.png" alt="pfsense set" width="1200"/>

</p>
Therefore, two corresponding host-only network cards need to be set up in VirtualBox in advance.
Meanwhile, it is recommended to turn off the NAT network card.


Special virtual machine downloadÔºöIn addition to the target machine information that can attack the chain file reading, as well as an Ubuntu and MacOS target machine.
To download the virtual machines, you just need to enter in -p. 

For example:
``` bash
python pull.py -p attacker/Ubuntu/macos -d download -vm C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe --url_table docs\url_table.csv -nr
```

#### Attack emulation infrastructure

<p align="center">

<img src="images/the%20emulation%20infrastructure.jpg" alt="cli output" width="1200"/>

</p>

Attackers: Kali,Windows 10<br> DNS_server: Debian<br> Firewall: pfSense<br> VictimsÔºöWindows 10,macOS,Ubuntu<br>

You can visit this [doc](https://github.com/LexusWang/Aurora-demos/blob/main/docs/Emulation_Infrastructure_info.md) to view more detailed information about the simulation environment.

### 2. Generate attack scripts:

The logic of the script is to configure itself based on the `executor` provided in the `attack_plan.yml`. The script reads `command` and `arguments` by determining the type of `executor` specified. Additionally, it explicitly extracts `arguments` marked as `Required: true` from the `exploit` and `payload` sections of the file and outputs them directly into the executable script. This design simplifies user configuration and minimizes manual intervention. After executing this script, users will obtain a large number of ready-to-run attack scripts, streamlining the setup process and saving operational time.

``` bash
python generateExecution.py
```

<p align="center">

<img src="images/generateExecution.gif" alt="editor" align="center"/>

</p>

### 3. Execute attack scripts:

We've generated executable attack scripts with AURORA and placed them in [here](https://github.com/LexusWang/Aurora-demos/tree/main/attack_execution_scripts) .Once your environment is configured, simply open the console, run the scripts, and follow the on-screen instructions to execute the attack.

```bash
python ../results/execution_xxxx.py
```
Click the following headings for details:
<details>
<summary>EXAMPLE-1_execution_keyboard_input_simulated-3</summary>

This attack plan uses `Metasploit` and `Sliver` tools to compromise Windows systems. First, a listener is established to capture incoming connections. A malicious `Sliver` payload is then created and delivered by tricking the victim into downloading/running it, granting remote access. Finally, this access is leveraged to deploy a stealthy `Meterpreter` payload via `Sliver` for data exfiltration (`keyboard input simulation`)


![progress](images/example1.gif)

</details>

<details>
<summary>EXAMPLE-2_execution_file_info_known-1</summary>

This attack simulation targets Windows systems using `Sliver` and `Metasploit`. It starts by creating a `Sliver` implant (malicious.exe) and tricking the victim into downloading/running it as Administrator. This grants attackers an elevated `Sliver` C2 session. Next, a `Metasploit` listener is set up to catch a reverse HTTPS payload ("meterpreter_reverse_http") deployed through `Sliver`, enabling a stealthy `Meterpreter` session. Finally, attackers use `Meterpreter` to search for sensitive files (like *.txt) on compromised machines.


![progress](images/example2.gif)
</details>

## Licensing
Distributed under the MIT License. See `LICENSE.txt` for more information. The attack chains are for education, research, and testing purpose.
The author does not condone any illegal use.
Use as your own risk.

## Contact the Contributors!
- Lingzhi Wang - [lingzhiwang2025@u.northwestern.edu](lingzhiwang2025@u.northwestern.edu)
- Yi Jiang - [jiangyi99@zju.edu.cn](jiangyi99@zju.edu.cn)
- Zhengkai Wang - [wangzhengkai@zju.edu.cn](wangzhengkai@zju.edu.cn)
