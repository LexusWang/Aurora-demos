Darkhotel (APT-C-06) Group's Multiple Attack Campaigns Leveraging Thinmon Backdoor Framework Exposed
During March 2020, 360 Security Brain discovered and disclosed APT attacks conducted by the peninsula-related APT group Darkhotel (APT-C-06) targeting Chinese government agencies and overseas institutions through VPN software vulnerabilities. The group employed a series of novel backdoor frameworks named "Thinmon" by 360 Advanced Threat Research Institute based on filenames, previously undisclosed in cybersecurity circles. Through tracking Darkhotel's activities using the Thinmon framework, we identified continuous attacks spanning three years since 2017, primarily focusing on long-term surveillance and confidential data theft. Victims were concentrated in North China and coastal regions, targeting government agencies, news media, large state-owned enterprises, and foreign trade entities, with foreign-related organizations constituting the majority. The group consistently updated their backdoor framework throughout this period. Our telemetry data shows victims predominantly located in eastern coastal areas and regions near the Korean Peninsula. Affected industries included government (25%), foreign trade, media, and educational institutions, with over 70% involving foreign-related operations. The group employs watering hole attacks and vulnerability exploitation, deploying modular backdoor components. A typical watering hole attack involved compromised Korean adult websites distributing malicious QuickTime installers. Loader components decrypt shellcode as EnumWindows callback functions to execute payloads. Vulnerability exploitation tactics included compromising security software update servers to distribute fake patches (e.g., KB3928472.exe) leveraging ActiveX COM interfaces, OA software vulnerabilities for malicious JS script execution, and VPN upgrade mechanisms to replace legitimate clients with backdoors. Persistence mechanisms involved multiple techniques: IKEEXT service hijacking through wlbsctrl.dll, Print Spooler service abuse via thinmon.dll, and COM hijacking through registry manipulation targeting {46C166AA-3108-11D4-9348-00C04F8EEB71}. The core framework consists of a ReflectiveLoader scheduler module (thinmon.dll/wlbsctrl.dll) that loads encrypted plugins, maintaining persistence through mutex checks and environment detection. Remote control modules incorporate Meterpreter's metsrv.dll structure. Captured plugins include keyloggers using SetWindowsHookExA, USB file stealers targeting specific extensions (txt, doc, xls, etc.), and screenshot modules checking .scr processes. Attribution analysis revealed code similarities with Darkhotel's historical samples including XOR-based decryption routines using 64-byte keys and functional overlaps with legacy tools like lucker. Keyboard logging components shared identical hook handling mechanisms, while file theft modules exhibited matching target extensions and encryption methods. 360's threat intelligence products have implemented detection capabilities for these TTPs, with continuous monitoring ongoing through APT Panoramic Radar and cloud-based threat platforms.