APT-C-20, also known as APT28, Fancy Bear, Pawn Storm, Sofacy Group, Sednit, STIONTIUM, etc., is an APT group with ties to military intelligence agencies. Its earliest known attack activities date back to between 2004 and 2007, primarily targeting government agencies, diplomatic institutions, and research organizations in North America, Central Asia, and Europe. On July 1, 2020, the 360 Advanced Threat Research Institute tracked and analyzed APT28's attack activities against diplomatic institutions in Eastern Europe and Central Asia, publishing the analysis report "Fancy Bear Roaming in Eastern Europe and Central Asia" [1]. Recently, we observed APT28 upgrading its tactics, techniques, and procedures (TTPs), employing new weapons like the Nim Zebrocy Downloader and Delphi Zebrocy Downloader to target NATO and Central Asian entities. Their latest attack method utilizes ARJ compressed archives and VHD virtual disk formats to package malicious payloads. Some antivirus solutions have scanning mechanism deficiencies for these less common archive formats, potentially allowing related malicious files to evade detection. The Nim Zebrocy Downloader has been frequently used by APT28 in past attacks. Zebrocy Downloader variants include Delphi, Nim, AutoIt, VB.NET, Visual C++, C#, and Go versions. Its primary function is to collect information from the target computer and, upon target confirmation, deploy the next stage of attack components. Analysis of Attack Activity: In suspected attacks targeting NATO organizations, APT28 employed the Nim version of the Zebrocy Downloader. It continued using compressed archive attachments as lures, but this time utilized the less common ARJ format. The archive contained a Nim Zebrocy Downloader and a decoy document. The archive was packed on August 5, 2020. Between July and August 2020, we captured multiple test versions of APT28's Nim Zebrocy Downloader. The decoy document content is as follows: The NATO Science and Technology Organization (STO) Applied Vehicle Technology (AVT) Panel is organizing a Research Workshop (RWS) on "Intelligent Solutions for Improving Mission Readiness for Military UxVs". The RWS website provided an "AVT-355 Call for Participation.pdf". The attackers disguised the Nim Zebrocy Downloader as this document within the archive, enticing the target to click and execute it. Technical Details Analysis: File information: MD5: 98e304e28a51acd92a363346c2b02b2f, Timestamp: 1970-01-01 08:00:00. Functionally similar to the Delphi Zebrocy Downloader, the Nim version primarily gathers target computer information and screenshots, sending the data to the C2 server. After obtaining the screenshot, the Nim Zebrocy Downloader writes it to C:/Users/Public/Videos/$$temp.tmp, reads the file, and then transmits it to the C2. It then displays the following pop-up message to deceive the user. The downloader uses WMI commands like wmic os get Caption,CSDVersion,osarchitecture /value to collect system information (e.g., OS version). This information, along with the screenshot data and the current system time, is Base64 encoded and sent via an HTTP POST request to the C2. The POST data keys are: adsges (system time), wefwqw (system info), hntyry (screenshot data). Delphi Zebrocy Downloader: Between July and October 2020, we captured multiple attack campaigns by APT28 utilizing the Delphi Zebrocy Downloader. In a suspected attack targeting a Central Asian diplomatic institution, APT28 again used compressed archives containing the Delphi Zebrocy for the attack. Attack Activity Analysis: In one specific attack, we captured a new sample where the Delphi Zebrocy Downloader was packaged inside a Virtual Hard Disk (VHD) file. When opened with certain archiving software or via file association, these files are displayed through disk mounting. Some antivirus software neglects scanning VHD file formats and may also overlook the contents of the virtual disk. Attackers exploit this characteristic to evade antivirus scanning and detection. The decoy document content is as follows: Technical Details Analysis: Functionally, this Delphi Zebrocy Downloader is identical to previous versions. Its main purpose is to gather user information and upload it to the C2 server, and it also possesses the capability to execute system commands. Upon execution, the sample checks if its filename contains "2020". If it does, it copies itself to C:\Users\purple\AppData\Roaming\Controller\scrssl.exe and runs from there. If the filename does not contain "2020", it creates a scheduled task named Windows\Component\ModuleUpd set to run every three minutes for persistence. It then launches winword.exe to open a decoy DOCX file with the same name located in the same directory, aiming to deceive the user. A key difference in this captured Zebrocy Delphi Downloader compared to previous versions is the change in string encoding. Older versions encoded command strings into hexadecimal strings. This newly captured version stores the command character strings in reversed order, as shown in the image depicting the command string used to create the scheduled task. VirusTotal detection results indicate that the VHD-packaged Delphi Zebrocy Downloader exhibits effective evasion capabilities (good "antivirus bypass" effect). Attack Correlation Analysis: In previous Delphi Zebrocy Downloaders, strings were encoded into hexadecimal. In the Nim Zebrocy Downloader, character information is first encoded into hexadecimal and then further encoded using Base64 before storage.