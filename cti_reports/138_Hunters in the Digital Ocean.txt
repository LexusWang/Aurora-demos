Hunters in the Digital Ocean  
Abstract Since April 2012, a foreign hacker group has launched organized, planned, and targeted long-term attacks against Chinese government agencies, research institutes, maritime authorities, maritime construction entities, shipping enterprises, and other critical sectors. We have designated this group as OceanLotus. The group primarily employs spear phishing and watering hole attacks combined with social engineering tactics to infiltrate specific domestic targets, delivering specialized Trojan programs to secretly control computer systems of government personnel, contractors, and industry experts, thereby stealing confidential information from related fields. Over 100 OceanLotus Trojan samples have been captured, with infections spanning 29 provincial-level regions in China and 36 foreign countries, where 3% of infections were in China. Beijing and Tianjin show the highest infection rates domestically. To conceal their activities, the group has registered at least 35 C2 server domains across six countries and utilized 19 server IP addresses distributed across over 13 countries globally. After February 2014, OceanLotus entered an active phase, launching its largest spear phishing campaign in May 2014 that infected numerous victims through malicious email attachments. Subsequent watering hole attacks targeted multiple government agencies, research institutes, and foreign-related enterprise websites in May and September 2014, as well as January 2015. OceanLotus has deployed four distinct Trojan variants. Early versions were technically simple and easily detectable, but post-2014 iterations incorporated file camouflage, random encryption, and self-destruct mechanisms to evade security software. By November 2014, cloud-controlled Trojans were introduced, significantly increasing attack risks and detection challenges. The prolonged attack duration (over three years), precise targeting, advanced techniques, and sophisticated social engineering indicate OceanLotus is not an ordinary cybercriminal group but likely a state-sponsored, highly organized foreign APT entity. Keywords: OceanLotus, APT, spear phishing, watering hole attack Chapter 1 OceanLotus Overview Since April 2012, a foreign hacker group has conducted systematic, sustained attacks against Chinese governmental, academic, maritime, and shipping sectors. The group employs spear phishing and watering hole attacks alongside social engineering to distribute specialized Trojans, compromising systems of government employees, contractors, and experts to exfiltrate sensitive data. The first OceanLotus Trojan was identified in April 2012, with over 100 samples of four variants captured since then. Infections span 29 Chinese provinces and 36 countries. The group operates 35 C2 domains across six countries and 19 IP addresses in 13 nations. Key milestones include: April 2012 (initial Trojan discovery), February 2014 (spear phishing escalation), May 2014 (peak spear phishing against marine research institutions), September 2014 (second watering hole wave), November 2014 (cloud-controlled Trojan deployment), and January 2015 (third major watering hole attack). Domestic infections constitute 92.3% of global cases, with Beijing (22.7%) and Tianjin (15.5%) as top affected regions. Early Trojans were rudimentary, but post-2014 versions adopted file masquerading, random encryption, and self-destruct features. Cloud-controlled variants since November 2014 further enhanced stealth and persistence. The group’s operational longevity, technical sophistication, and precision targeting suggest state-backed sponsorship. Chapter 2 OceanLotus Attack Methods The group primarily uses spear phishing (58.6%) and watering hole attacks (41.4%). Spear phishing involves malicious email attachments disguised as Word documents or JPG files, leveraging topical lures like "Latest Xinjiang Riot Photos" or "Civil Service Salary Reform." Filename truncation exploits Windows display limitations to hide ".exe" extensions. Attacks peak on weekdays, aligning with target work patterns. Watering hole attacks compromise target-associated websites to deliver malware via forged updates (e.g., fake Flash installers) or redirects to malicious downloads. Attack cycles typically last 3-5 days before reverting to conceal痕迹. Case studies include hijacked document servers distributing backdoored "Instant Messenger" software and government portals serving malicious RAR archives like "Urumqi Explosion Casualties.rar." The group employs OS-specific payloads (Windows/Mac) and registers domains globally (Bahamas, US, Nigeria) with WHOIS privacy. C2 infrastructure rotates across 35 domains and 19 IPs, including pad.werzo.net, shop.ownpro.net, and伪造的 Adobe subdomains. Chapter 3 Trojan Technical Analysis OceanLutus deploys four main Trojans: 1) Tester (2012): Basic spyware for early testing. 2) Encryptor (2014): Word/JPG-masquerading .exe files using recursive 64-bit key encryption, temp file execution, and self-deletion. Decrypted payloads (qq.exe loader + Bundle.rdb module) communicate with C2s like zone.mizove.com. 3) Cloudrunner (2014): Lightweight downloader fetching encrypted DLLs from http://dc.jaomao69.info/jUFF, injecting into rundll32 for data theft (emails, files, screens). 4) MAC variant: Targets MacOS via forged Flash updates, decrypting .en_icon/.DS_Stores files to connect C2s (kiifd.pozon7.net) with capabilities including file operations and process termination. Chapter 4 Capability Assessment The group demonstrates: 1) Chinese linguistic/cultural proficiency for social engineering. 2) Network intrusion and persistence skills. 3) Advanced malware development to bypass AV. Internal divisions likely include reconnaissance, intrusion, and tool development teams collaborating for intelligence gathering and payload delivery. Chapter 5 Attack Detection Challenges APT detection requires correlating scattered incidents across time/geography. 360 APT Team utilized big data analysis (billions of samples, endpoint logs, web crawls) to reconstruct OceanLotus' 3-year campaign spanning 29 provinces and 35 domains. Traditional siloed defenses struggle against such prolonged, polymorphic threats. Appendix 1 IOCs Malware MD5s: dfca5127134f7198d7cf4fccdafdc7e9, ed501e21e62359ffd6f4d8ca42e66e59, etc. Path: %appdata%\Tencent\QQ\qq.exe. Domains: download.mail-attach.net, fpdownload.shockwave.flashads.org, active.soariz.com. IPs: 146.0.43.107, 193.169.244.73. Appendix 2 Code Analysis Encryptor (MD5:70ca42bb9c3b6e49663fc532833874c3): Generates 64-bit key, encrypts resource section, drops decoy Word doc, executes temp file with --ping parameter. Decrypts to load qq.exe and Bundle.rdb, communicating with C2s via custom protocol (commands: file ops, registry access). Cloudrunner (MD5:3b6ba05d5d0f236cf0867f1d7fe1a25e): Creates mutex 9N557T5926632kM8BT8Mj9325k2N6R, downloads XOR-encrypted DLL from dc.jaomao69.info, injects into rundll32 for HTTP C2 tunneling.