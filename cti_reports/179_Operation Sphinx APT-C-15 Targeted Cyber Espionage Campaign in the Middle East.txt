Operation Sphinx APT-C-15 Targeted Cyber Espionage Campaign in the Middle East
Overview Operation Sphinx represents a cyber espionage campaign active in the Middle East targeting organizations in Egypt and Israel for sensitive data exfiltration. Activity peaked between June 2014 and November 2015, with earliest traces dating back to December 2011. The campaign employed social media-based watering hole attacks, utilizing 314 malware samples and 7 C&C domains. Malware disguised as documents drops multiple DLLs divided into 9 functional modules, achieving persistence through Explorer shell extensions. Core DLLs inject payloads into designated processes based on encrypted configuration files, leaving no main process visible. Anti-analysis measures include multiple encryption layers and continuous integration tool usage (evident through PDB paths), indicating professional development. Forensic evidence suggests Middle Eastern origins with potential third-party malware development support. Payload Delivery 1. Social Media Watering Hole Attack One Hebrew-lure document originated from Facebook comments on Israeli military pages. The campaign employed two modified watering hole techniques: 1) Compromising target-frequented sites with exploit code; 2) Replacing legitimate downloads with malicious links (e.g., 2014 Havex Trojan case). Ten fake social media accounts impersonating Israeli military/government entities (IDF, Navy, etc.) posted tax reform-themed comments during January-February 2015 to deliver payloads. 2. Lure Documents Arabic-language decoys referenced Egyptian political issues including Rabaa massacre protests. Hebrew documents focused on Israeli tax reforms. 3. File Masquerading Samples used two deception methods: 1) Document/image icons with non-functional content; 2) Fake installers releasing benign programs post-infection. Components masqueraded as Office plugins in %AppData%\officeplugin or C:\Program Files{GUID} directories. ROCK Backdoor Analysis 1. Functionality The ROCK malware (potentially custom-developed) and njRat variant (52f461a133e95328ccd9ba7f70e2f3e6) performed comprehensive surveillance: • System profiling • Keystroke/mouse logging • Skype chat/screenshot/audio capture • Webcam/mic recording • Browser credential/history extraction • File exfiltration (Office docs, images, etc.) 2. Modular Architecture 20 DLLs (10x32/64-bit) implement modular functions: zcore (main), zulib (API wrapper), plgcmd (system control), plgcomm (C2), plginput (input logging), plgurl (browser monitoring), plgskype (Skype espionage), plgavbug (AV/mic), plgusrstl (credential theft), plgfsflt (file filtering). Configuration files determine module activation/injection parameters. 3. C2 Communication HTTP POST via browser processes on port 80, with JSON-formatted data using substitution tables for string obfuscation. 4. Anti-Analysis Measures • Randomized filenames (gendarme.dll, jerques.dll) • Multi-algorithm string encryption • API obfuscation (300+ functions) • Process hollowing (explorer.exe/browser injection) • Zlib/AES-encrypted resources/configs • Fileless execution Operational Indicators 1. Facebook Accounts • ofir.hadad.963 • rafi.partook • %D7%90%D7%95%D7%94%D7%93_%D7%A4%D7%93%D7%99%D7%93%D7%94 • tuti.rotam.5 2. PDB Traces Build paths reveal developer ID "zico" and project name "ROCK-RW2-BRW6R": C:\Users\user\bamboo-agent-home\xml-data\build-dir\ROCK-RW2-BRW6R\x64\Release-RkLibDll Z:\rootkits\windows\zico\x64 3. Egyptian Infrastructure • C&C IPs: 196.205.194.60/.61 (Egypt) • njRat C2: 196.205.194.61 4. Decoy Document Titles Arabic: • ملف المعتقلات بجامعة الازهر (Al-Azhar University Detainees File) • ولاية سيناء-مخطط السيطرة الكامن (Sinai Control Scheme) Hebrew: • מס הכנסה- עדכונים (Income Tax Updates) Appendix A: Hebrew Sample Origins Social media accounts targeted Israeli military units (13th Flotilla, Navy), government officials (Miri Regev), and media outlets between January 31-February 4, 2015.