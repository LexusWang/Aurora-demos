Retrospective Analysis Report on Kimsuky Group's Cyber Attack Activities  
The Kimsuky group (also known as BabyShark, Thallium, Black Banshee, etc.), first disclosed by Kaspersky in 2013, has long targeted South Korean think tanks, government diplomatic agencies, and news media organizations for intelligence theft and espionage activities. During December 2020, 360 Advanced Threat Research Institute detected a spear-phishing campaign by this group. Through correlation analysis of related samples, we identified multiple compromised servers associated with their operations, uncovering clues about a series of cyber attacks. Analysis of their malware, backdoors, and test samples revealed characteristics unique to the group such as BabyShark. This report presents new insights into Kimsuky's attack methodologies. **Analysis of Spear-Phishing Campaign** The malicious macro document used in this campaign dynamically delivered VBS scripts via cloud-based payloads after enabling macros, making full-sample acquisition challenging. Through 360 Security Brain, we reconstructed partial attack samples and the complete attack chain. Key characteristics include: - DLL hijacking using libraries named version.dll, wtsapi32.dll, and version_hwp.dll - Replacement of Office templates with malicious Normal.dotm to execute macro code [0] - Utilization of OneDrive and compromised websites for dynamic payload delivery and command execution **version.dll** Triggers malicious code execution via curl to download tmp files, decodes them to %UserProfile%\AppData\Local\Temp, and renames to version.dll. Historical lure documents revealed expired download URLs: - https://assuredshippings.com/wp-admin/includes/1023k/c.php?op=dotm (dgdgdf.tmp) - https://assuredshippings.com/wp-admin/includes/1023k/d.php?op=ver.gif (version.dll) **wtsapi32.dll** Contains hardcoded Base64 strings representing two VBS scripts. The first writes to temporary files while the second directly executes parameters, downloading VBS code from OneDrive for decryption. Active OneDrive links included: - https://onedrive.live.com/?authkey=%21AA1TpZt2wbC2q34&cid=EA63197CF6E2BF62&id=EA63197CF6E2BF62%21137 Final VBS scripts sent alive signals to https://assuredshippings[.]com/wp-admin/css/colors/coffee/alive.php?op=[username]. **version_hwp.dll** Fetched execution commands from Google Drive (e.g., https://drive[.]google[.]com/file/d/1X4hJhlAjqVk7cChNSBt_SCrTi07LMVN7) to download DLL hijacking libraries via curl. **VBS Scripts** ctr.vbs in %UserProfile%\AppData\Local\Temp\ decoded and executed obfuscated VBS code, establishing scheduled tasks to dynamically read registry entries. desktop.tmp collected username, process lists, and directory information encoded via certutil for exfiltration. PowerShell commands used Quasar RAT mutex names, suggesting open-source tool usage. **Compromised Server Tracking** 360 Security Brain telemetry revealed multiple infected servers hosting detect.vbs samples executed via scheduled tasks to report IP addresses. Servers exhibited RDP scanning tools (3389 port open) and TeamViewer usage, suggesting brute-force or vulnerability exploitation. Malicious test samples and attack toolkits were discovered, including: - doc-src.doc (password-protected macro documents checking antivirus status via http://okbus[.]or[.]kr/libs/phpmailer/his[.]php) - Two execution strategies ultimately downloading desktop.tmp from https://newspeers[.]com/000/wjb/expres[.]php?op=2 **Remote Control Test Samples** Batch files like change_with_anydesk_now.bat demonstrated AnyDesk integration for covert persistence. PE files exposed development paths: - ieupsrv.exe: G:\414 task\ImpersonateService\ImpersonateService\Release\ImpersonateService.pdb - ieupdate.exe: G:\414 task\hidewindows_complete\any_exe\any_exe\Release\any_exe.pdb **Attack Toolkits** Compressed packages contained: - mimikatz.rar (credential theft) - KPortScan 3.0 - RDPWrap-v1.6.2 (multi-user RDP) - browser password/cookie extraction tools - PE files with Korean language resources **Additional Findings** Compromised servers showed coinmining (xmrig.exe) and ransomware (mail@rapid2019.com.url) artifacts, though no direct Kimsuky linkage was confirmed. **Attack Correlation** Decryption algorithms in ctr.vbs, funwifuv, and ieCert.vbs matched estsecurity reports [1]. URL parameter patterns (e.g., ?op=ver.gif) aligned with historical campaigns [2]. Command string stripping in version.dll and update.vbs shared unique prefix/suffix handling. **Conclusion** Kimsuky leverages third-party cloud platforms and compromised websites as attack infrastructure, expanding beyond high-value targets to general enterprises. Their operations combine persistent intelligence-gathering with opportunistic server exploitation for attack staging, coinmining, and C2. Organizations must enhance network security to avoid becoming APT accomplices.